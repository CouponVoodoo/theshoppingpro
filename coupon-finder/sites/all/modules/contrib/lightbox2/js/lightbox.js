var Lightbox;(function(e){Lightbox={auto_modal:false,overlayOpacity:.8,overlayColor:"000",disableCloseClick:true,resizeSequence:0,resizeSpeed:"normal",fadeInSpeed:"normal",slideDownSpeed:"slow",minWidth:240,borderSize:10,boxColor:"fff",fontColor:"000",topPosition:"",infoHeight:20,alternative_layout:false,imageArray:[],imageNum:null,total:0,activeImage:null,inprogress:false,disableResize:false,disableZoom:false,isZoomedIn:false,rtl:false,loopItems:false,keysClose:["c","x",27],keysPrevious:["p",37],keysNext:["n",39],keysZoom:["z"],keysPlayPause:[32],slideInterval:5e3,showPlayPause:true,autoStart:true,autoExit:true,pauseOnNextClick:false,pauseOnPrevClick:true,slideIdArray:[],slideIdCount:0,isSlideshow:false,isPaused:false,loopSlides:false,isLightframe:false,iframe_width:600,iframe_height:400,iframe_border:1,enableVideo:false,flvPlayer:"/flvplayer.swf",flvFlashvars:"",isModal:false,isVideo:false,videoId:false,modalWidth:400,modalHeight:400,modalHTML:null,initialize:function(){var t=Drupal.settings.lightbox2;Lightbox.overlayOpacity=t.overlay_opacity;Lightbox.overlayColor=t.overlay_color;Lightbox.disableCloseClick=t.disable_close_click;Lightbox.resizeSequence=t.resize_sequence;Lightbox.resizeSpeed=t.resize_speed;Lightbox.fadeInSpeed=t.fade_in_speed;Lightbox.slideDownSpeed=t.slide_down_speed;Lightbox.borderSize=t.border_size;Lightbox.boxColor=t.box_color;Lightbox.fontColor=t.font_color;Lightbox.topPosition=t.top_position;Lightbox.rtl=t.rtl;Lightbox.loopItems=t.loop_items;Lightbox.keysClose=t.keys_close.split(" ");Lightbox.keysPrevious=t.keys_previous.split(" ");Lightbox.keysNext=t.keys_next.split(" ");Lightbox.keysZoom=t.keys_zoom.split(" ");Lightbox.keysPlayPause=t.keys_play_pause.split(" ");Lightbox.disableResize=t.disable_resize;Lightbox.disableZoom=t.disable_zoom;Lightbox.slideInterval=t.slideshow_interval;Lightbox.showPlayPause=t.show_play_pause;Lightbox.showCaption=t.show_caption;Lightbox.autoStart=t.slideshow_automatic_start;Lightbox.autoExit=t.slideshow_automatic_exit;Lightbox.pauseOnNextClick=t.pause_on_next_click;Lightbox.pauseOnPrevClick=t.pause_on_previous_click;Lightbox.loopSlides=t.loop_slides;Lightbox.alternative_layout=t.use_alt_layout;Lightbox.iframe_width=t.iframe_width;Lightbox.iframe_height=t.iframe_height;Lightbox.iframe_border=t.iframe_border;Lightbox.enableVideo=t.enable_video;if(t.enable_video){Lightbox.flvPlayer=t.flvPlayer;Lightbox.flvFlashvars=t.flvFlashvars}var n=t.use_alt_layout?"lightbox2-alt-layout":"lightbox2-orig-layout";var r='<div id="lightbox2-overlay" style="display: none;"></div>      <div id="lightbox" style="display: none;" class="'+n+'">        <div id="outerImageContainer"></div>        <div id="imageDataContainer" class="clearfix">          <div id="imageData"></div>        </div>      </div>';var i='<div id="loading"><a href="#" id="loadingLink"></a></div>';var s='<div id="modalContainer" style="display: none;"></div>';var o='<div id="frameContainer" style="display: none;"></div>';var u='<div id="imageContainer" style="display: none;"></div>';var a='<div id="imageDetails"></div>';var f='<div id="bottomNav"></div>';var l='<img id="lightboxImage" alt="" />';var c='<div id="hoverNav"><a id="prevLink" href="#"></a><a id="nextLink" href="#"></a></div>';var h='<div id="frameHoverNav"><a id="framePrevLink" href="#"></a><a id="frameNextLink" href="#"></a></div>';var c='<div id="hoverNav"><a id="prevLink" title="'+Drupal.t("Previous")+'" href="#"></a><a id="nextLink" title="'+Drupal.t("Next")+'" href="#"></a></div>';var h='<div id="frameHoverNav"><a id="framePrevLink" title="'+Drupal.t("Previous")+'" href="#"></a><a id="frameNextLink" title="'+Drupal.t("Next")+'" href="#"></a></div>';var p='<span id="caption"></span>';var d='<span id="numberDisplay"></span>';var v='<a id="bottomNavClose" title="'+Drupal.t("Close")+'" href="#"></a>';var m='<a id="bottomNavZoom" href="#"></a>';var g='<a id="bottomNavZoomOut" href="#"></a>';var y='<a id="lightshowPause" title="'+Drupal.t("Pause Slideshow")+'" href="#" style="display: none;"></a>';var b='<a id="lightshowPlay" title="'+Drupal.t("Play Slideshow")+'" href="#" style="display: none;"></a>';e("body").append(r);e("#outerImageContainer").append(s+o+u+i);if(!t.use_alt_layout){e("#imageContainer").append(l+c);e("#imageData").append(a+f);e("#imageDetails").append(p+d);e("#bottomNav").append(h+v+m+g+y+b)}else{e("#outerImageContainer").append(f);e("#imageContainer").append(l);e("#bottomNav").append(v+m+g);e("#imageData").append(c+a);e("#imageDetails").append(p+d+y+b)}if(Lightbox.disableCloseClick){e("#lightbox2-overlay").click(function(){Lightbox.end();return false}).hide()}e("#loadingLink, #bottomNavClose").click(function(){Lightbox.end("forceClose");return false});e("#prevLink, #framePrevLink").click(function(){Lightbox.changeData(Lightbox.activeImage-1);return false});e("#nextLink, #frameNextLink").click(function(){Lightbox.changeData(Lightbox.activeImage+1);return false});e("#bottomNavZoom").click(function(){Lightbox.changeData(Lightbox.activeImage,true);return false});e("#bottomNavZoomOut").click(function(){Lightbox.changeData(Lightbox.activeImage,false);return false});e("#lightshowPause").click(function(){Lightbox.togglePlayPause("lightshowPause","lightshowPlay");return false});e("#lightshowPlay").click(function(){Lightbox.togglePlayPause("lightshowPlay","lightshowPause");return false});e("#prevLink, #nextLink, #framePrevLink, #frameNextLink").css({paddingTop:Lightbox.borderSize+"px"});e("#imageContainer, #frameContainer, #modalContainer").css({padding:Lightbox.borderSize+"px"});e("#outerImageContainer, #imageDataContainer, #bottomNavClose").css({backgroundColor:"#"+Lightbox.boxColor,color:"#"+Lightbox.fontColor});if(Lightbox.alternative_layout){e("#bottomNavZoom, #bottomNavZoomOut").css({bottom:Lightbox.borderSize+"px",right:Lightbox.borderSize+"px"})}else if(Lightbox.rtl==1&&e.browser.msie){e("#bottomNavZoom, #bottomNavZoomOut").css({left:"0px"})}if(t.force_show_nav){e("#prevLink, #nextLink").addClass("force_show_nav")}},initList:function(t){if(t==undefined||t==null){t=document}e("a[rel^='lightbox']:not(.lightbox-processed), area[rel^='lightbox']:not(.lightbox-processed)",t).addClass("lightbox-processed").click(function(t){if(Lightbox.disableCloseClick){e("#lightbox").unbind("click");e("#lightbox").click(function(){Lightbox.end("forceClose")})}Lightbox.start(this,false,false,false,false);if(t.preventDefault){t.preventDefault()}return false});e("a[rel^='lightshow']:not(.lightbox-processed), area[rel^='lightshow']:not(.lightbox-processed)",t).addClass("lightbox-processed").click(function(t){if(Lightbox.disableCloseClick){e("#lightbox").unbind("click");e("#lightbox").click(function(){Lightbox.end("forceClose")})}Lightbox.start(this,true,false,false,false);if(t.preventDefault){t.preventDefault()}return false});e("a[rel^='lightframe']:not(.lightbox-processed), area[rel^='lightframe']:not(.lightbox-processed)",t).addClass("lightbox-processed").click(function(t){if(Lightbox.disableCloseClick){e("#lightbox").unbind("click");e("#lightbox").click(function(){Lightbox.end("forceClose")})}Lightbox.start(this,false,true,false,false);if(t.preventDefault){t.preventDefault()}return false});if(Lightbox.enableVideo){e("a[rel^='lightvideo']:not(.lightbox-processed), area[rel^='lightvideo']:not(.lightbox-processed)",t).addClass("lightbox-processed").click(function(t){if(Lightbox.disableCloseClick){e("#lightbox").unbind("click");e("#lightbox").click(function(){Lightbox.end("forceClose")})}Lightbox.start(this,false,false,true,false);if(t.preventDefault){t.preventDefault()}return false})}e("a[rel^='lightmodal']:not(.lightbox-processed), area[rel^='lightmodal']:not(.lightbox-processed)",t).addClass("lightbox-processed").click(function(t){e("#lightbox").unbind("click");e("#lightbox").addClass(e(this).attr("class"));e("#lightbox").removeClass("lightbox-processed");Lightbox.start(this,false,false,false,true);if(t.preventDefault){t.preventDefault()}return false});e("#lightboxAutoModal:not(.lightbox-processed)",t).addClass("lightbox-processed").click(function(t){Lightbox.auto_modal=true;e("#lightbox").unbind("click");Lightbox.start(this,false,false,false,true);if(t.preventDefault){t.preventDefault()}return false})},start:function(t,n,r,i,s){Lightbox.isPaused=!Lightbox.autoStart;Lightbox.toggleSelectsFlash("hide");var o=Lightbox.getPageSize();e("#lightbox2-overlay").hide().css({width:"100%",zIndex:"10090",height:o[1]+"px",backgroundColor:"#"+Lightbox.overlayColor});if(i&&this.detectMacFF2()){e("#lightbox2-overlay").removeClass("overlay_default");e("#lightbox2-overlay").addClass("overlay_macff2");e("#lightbox2-overlay").css({opacity:null})}else{e("#lightbox2-overlay").removeClass("overlay_macff2");e("#lightbox2-overlay").addClass("overlay_default");e("#lightbox2-overlay").css({opacity:Lightbox.overlayOpacity})}e("#lightbox2-overlay").fadeIn(Lightbox.fadeInSpeed);Lightbox.isSlideshow=n;Lightbox.isLightframe=r;Lightbox.isVideo=i;Lightbox.isModal=s;Lightbox.imageArray=[];Lightbox.imageNum=0;var u=e(t.tagName);var a=null;var f=Lightbox.parseRel(t);var l=f["rel"];var c=f["group"];var h=f["title"]?f["title"]:t.title;var p=null;var d=0;if(f["flashvars"]){Lightbox.flvFlashvars=Lightbox.flvFlashvars+"&"+f["flashvars"]}var v=t.title;if(!v){var m=e(t).find("img");if(m&&e(m).attr("alt")){v=e(m).attr("alt")}else{v=h}}if(e(t).attr("id")=="lightboxAutoModal"){p=f["style"];Lightbox.imageArray.push(["#lightboxAutoModal > *",h,v,p,1])}else{if((l=="lightbox"||l=="lightshow")&&!c){Lightbox.imageArray.push([t.href,h,v])}else if(!c){p=f["style"];Lightbox.imageArray.push([t.href,h,v,p])}else{for(d=0;d<u.length;d++){a=u[d];if(a.href&&typeof a.href=="string"&&e(a).attr("rel")){var g=Lightbox.parseRel(a);var y=g["title"]?g["title"]:a.title;img_alt=a.title;if(!img_alt){var b=e(a).find("img");if(b&&e(b).attr("alt")){img_alt=e(b).attr("alt")}else{img_alt=h}}if(g["rel"]==l){if(g["group"]==c){if(Lightbox.isLightframe||Lightbox.isModal||Lightbox.isVideo){p=g["style"]}Lightbox.imageArray.push([a.href,y,img_alt,p])}}}}for(d=0;d<Lightbox.imageArray.length;d++){for(j=Lightbox.imageArray.length-1;j>d;j--){if(Lightbox.imageArray[d][0]==Lightbox.imageArray[j][0]){Lightbox.imageArray.splice(j,1)}}}while(Lightbox.imageArray[Lightbox.imageNum][0]!=t.href){Lightbox.imageNum++}}}if(Lightbox.isSlideshow&&Lightbox.showPlayPause&&Lightbox.isPaused){e("#lightshowPlay").show();e("#lightshowPause").hide()}var w=Lightbox.getPageScroll();var E=w[1]+(Lightbox.topPosition==""?o[3]/10:Lightbox.topPosition)*1;var S=w[0];e("#frameContainer, #modalContainer, #lightboxImage").hide();e("#hoverNav, #prevLink, #nextLink, #frameHoverNav, #framePrevLink, #frameNextLink").hide();e("#imageDataContainer, #numberDisplay, #bottomNavZoom, #bottomNavZoomOut").hide();e("#outerImageContainer").css({width:"250px",height:"250px"});e("#lightbox").css({zIndex:"10500",top:E+"px",left:S+"px"}).show();Lightbox.total=Lightbox.imageArray.length;Lightbox.changeData(Lightbox.imageNum)},changeData:function(t,n){if(Lightbox.inprogress===false){if(Lightbox.total>1&&(Lightbox.isSlideshow&&Lightbox.loopSlides||!Lightbox.isSlideshow&&Lightbox.loopItems)){if(t>=Lightbox.total)t=0;if(t<0)t=Lightbox.total-1}if(Lightbox.isSlideshow){for(var r=0;r<Lightbox.slideIdCount;r++){window.clearTimeout(Lightbox.slideIdArray[r])}}Lightbox.inprogress=true;Lightbox.activeImage=t;if(Lightbox.disableResize&&!Lightbox.isSlideshow){n=true}Lightbox.isZoomedIn=n;e("#loading").css({zIndex:"10500"}).show();if(!Lightbox.alternative_layout){e("#imageContainer").hide()}e("#frameContainer, #modalContainer, #lightboxImage").hide();e("#hoverNav, #prevLink, #nextLink, #frameHoverNav, #framePrevLink, #frameNextLink").hide();e("#imageDataContainer, #numberDisplay, #bottomNavZoom, #bottomNavZoomOut").hide();if(!Lightbox.isLightframe&&!Lightbox.isVideo&&!Lightbox.isModal){e("#lightbox #imageDataContainer").removeClass("lightbox2-alt-layout-data");imgPreloader=new Image;imgPreloader.onerror=function(){Lightbox.imgNodeLoadingError(this)};imgPreloader.onload=function(){var t=document.getElementById("lightboxImage");t.src=Lightbox.imageArray[Lightbox.activeImage][0];t.alt=Lightbox.imageArray[Lightbox.activeImage][2];var r=imgPreloader.width;var i=imgPreloader.height;var s=Lightbox.getPageSize();var o={w:s[2]-Lightbox.borderSize*2,h:s[3]-Lightbox.borderSize*6-Lightbox.infoHeight*4-s[3]/10};var u={w:imgPreloader.width,h:imgPreloader.height};if(n!==true){var a=1;e("#bottomNavZoomOut, #bottomNavZoom").hide();if((u.w>=o.w||u.h>=o.h)&&u.h&&u.w){a=o.w/u.w<o.h/u.h?o.w/u.w:o.h/u.h;if(!Lightbox.disableZoom&&!Lightbox.isSlideshow){e("#bottomNavZoom").css({zIndex:"10500"}).show()}}r=Math.floor(u.w*a);i=Math.floor(u.h*a)}else{e("#bottomNavZoom").hide();if((u.w>=o.w||u.h>=o.h)&&u.h&&u.w){if(!Lightbox.disableResize&&Lightbox.isSlideshow===false&&!Lightbox.disableZoom){e("#bottomNavZoomOut").css({zIndex:"10500"}).show()}}}t.style.width=r+"px";t.style.height=i+"px";Lightbox.resizeContainer(r,i);imgPreloader.onload=function(){}};imgPreloader.src=Lightbox.imageArray[Lightbox.activeImage][0];imgPreloader.alt=Lightbox.imageArray[Lightbox.activeImage][2]}else if(Lightbox.isLightframe){e("#lightbox #imageDataContainer").addClass("lightbox2-alt-layout-data");var i=Lightbox.imageArray[Lightbox.activeImage][0];e("#frameContainer").html('<iframe id="lightboxFrame" style="display: none;" src="'+i+'"></iframe>');if(e.browser.mozilla&&i.indexOf(".swf")!=-1){setTimeout(function(){document.getElementById("lightboxFrame").src=Lightbox.imageArray[Lightbox.activeImage][0]},1e3)}if(!Lightbox.iframe_border){e("#lightboxFrame").css({border:"none"});e("#lightboxFrame").attr("frameborder","0")}var s=document.getElementById("lightboxFrame");var o=Lightbox.imageArray[Lightbox.activeImage][3];s=Lightbox.setStyles(s,o);Lightbox.resizeContainer(parseInt(s.width,10),parseInt(s.height,10))}else if(Lightbox.isVideo||Lightbox.isModal){e("#lightbox #imageDataContainer").addClass("lightbox2-alt-layout-data");var u=document.getElementById("modalContainer");var a=Lightbox.imageArray[Lightbox.activeImage][3];u=Lightbox.setStyles(u,a);if(Lightbox.isVideo){Lightbox.modalHeight=parseInt(u.height,10)-10;Lightbox.modalWidth=parseInt(u.width,10)-10;Lightvideo.startVideo(Lightbox.imageArray[Lightbox.activeImage][0])}Lightbox.resizeContainer(parseInt(u.width,10),parseInt(u.height,10))}}},imgNodeLoadingError:function(e){var t=Drupal.settings.lightbox2;var n=Lightbox.imageArray[Lightbox.activeImage][0];if(t.display_image_size!==""){n=n.replace(new RegExp("."+t.display_image_size),"")}Lightbox.imageArray[Lightbox.activeImage][0]=n;e.onerror=function(){Lightbox.imgLoadingError(e)};e.src=n},imgLoadingError:function(e){var t=Drupal.settings.lightbox2;Lightbox.imageArray[Lightbox.activeImage][0]=t.default_image;e.src=t.default_image},resizeContainer:function(t,n){t=t<Lightbox.minWidth?Lightbox.minWidth:t;this.widthCurrent=e("#outerImageContainer").width();this.heightCurrent=e("#outerImageContainer").height();var r=t+Lightbox.borderSize*2;var i=n+Lightbox.borderSize*2;this.xScale=r/this.widthCurrent*100;this.yScale=i/this.heightCurrent*100;wDiff=this.widthCurrent-r;hDiff=this.heightCurrent-i;e("#modalContainer").css({width:t,height:n});if(Lightbox.resizeSequence){var s={width:r};var o={height:i};if(Lightbox.resizeSequence==2){s={height:i};o={width:r}}e("#outerImageContainer").animate(s,Lightbox.resizeSpeed).animate(o,Lightbox.resizeSpeed,"linear",function(){Lightbox.showData()})}else{e("#outerImageContainer").animate({width:r,height:i},Lightbox.resizeSpeed,"linear",function(){Lightbox.showData()})}if(hDiff===0&&wDiff===0){if(e.browser.msie){Lightbox.pause(250)}else{Lightbox.pause(100)}}var u=Drupal.settings.lightbox2;if(!u.use_alt_layout){e("#prevLink, #nextLink").css({height:n+"px"})}e("#imageDataContainer").css({width:r+"px"})},showData:function(){e("#loading").hide();if(Lightbox.isLightframe||Lightbox.isVideo||Lightbox.isModal){Lightbox.updateDetails();if(Lightbox.isLightframe){e("#frameContainer").show();if(e.browser.safari||Lightbox.fadeInSpeed===0){e("#lightboxFrame").css({zIndex:"10500"}).show()}else{e("#lightboxFrame").css({zIndex:"10500"}).fadeIn(Lightbox.fadeInSpeed)}}else{if(Lightbox.isVideo){e("#modalContainer").html(Lightbox.modalHTML).click(function(){return false}).css("zIndex","10500").show()}else{var t=unescape(Lightbox.imageArray[Lightbox.activeImage][0]);if(Lightbox.imageArray[Lightbox.activeImage][4]){e(t).appendTo("#modalContainer");e("#modalContainer").css({zIndex:"10500"}).show()}else{e("#modalContainer").hide().load(t,function(){e("#modalContainer").css({zIndex:"10500"}).show()})}e("#modalContainer").unbind("click")}}}else{e("#imageContainer").show();if(e.browser.safari||Lightbox.fadeInSpeed===0){e("#lightboxImage").css({zIndex:"10500"}).show()}else{e("#lightboxImage").css({zIndex:"10500"}).fadeIn(Lightbox.fadeInSpeed)}Lightbox.updateDetails();this.preloadNeighborImages()}Lightbox.inprogress=false;if(Lightbox.isSlideshow){if(!Lightbox.loopSlides&&Lightbox.activeImage==Lightbox.total-1){if(Lightbox.autoExit){Lightbox.slideIdArray[Lightbox.slideIdCount++]=setTimeout(function(){Lightbox.end("slideshow")},Lightbox.slideInterval)}}else{if(!Lightbox.isPaused&&Lightbox.total>1){Lightbox.slideIdArray[Lightbox.slideIdCount++]=setTimeout(function(){Lightbox.changeData(Lightbox.activeImage+1)},Lightbox.slideInterval)}}if(Lightbox.showPlayPause&&Lightbox.total>1&&!Lightbox.isPaused){e("#lightshowPause").show();e("#lightshowPlay").hide()}else if(Lightbox.showPlayPause&&Lightbox.total>1){e("#lightshowPause").hide();e("#lightshowPlay").show()}}var n=Lightbox.getPageSize();var r=Lightbox.getPageScroll();var i=n[1];if(Lightbox.isZoomedIn&&n[1]>n[3]){var s=(Lightbox.topPosition==""?n[3]/10:Lightbox.topPosition)*1;i=i+r[1]+s}e("#lightbox2-overlay").css({height:i+"px",width:n[0]+"px"});if(e.browser.mozilla){if(Lightbox.imageArray[Lightbox.activeImage][0].indexOf(".pdf")!=-1){setTimeout(function(){document.getElementById("lightboxFrame").src=Lightbox.imageArray[Lightbox.activeImage][0]},1e3)}}},updateDetails:function(){e("#imageDataContainer").hide();var t=Drupal.settings.lightbox2;if(t.show_caption){var n=Lightbox.filterXSS(Lightbox.imageArray[Lightbox.activeImage][1]);if(!n)n="";e("#caption").html(n).css({zIndex:"10500"}).show()}var r=null;if(t.image_count&&Lightbox.total>1){var i=Lightbox.activeImage+1;if(!Lightbox.isLightframe&&!Lightbox.isModal&&!Lightbox.isVideo){r=t.image_count.replace(/\!current/,i).replace(/\!total/,Lightbox.total)}else if(Lightbox.isVideo){r=t.video_count.replace(/\!current/,i).replace(/\!total/,Lightbox.total)}else{r=t.page_count.replace(/\!current/,i).replace(/\!total/,Lightbox.total)}e("#numberDisplay").html(r).css({zIndex:"10500"}).show()}else{e("#numberDisplay").hide()}e("#imageDataContainer").hide().slideDown(Lightbox.slideDownSpeed,function(){e("#bottomNav").show()});if(Lightbox.rtl==1){e("#bottomNav").css({"float":"left"})}Lightbox.updateNav()},updateNav:function(){e("#hoverNav").css({zIndex:"10500"}).show();var t="#prevLink";var n="#nextLink";if(Lightbox.isSlideshow){if(Lightbox.total>1&&Lightbox.loopSlides||Lightbox.activeImage!==0){e(t).css({zIndex:"10500"}).show().click(function(){if(Lightbox.pauseOnPrevClick){Lightbox.togglePlayPause("lightshowPause","lightshowPlay")}Lightbox.changeData(Lightbox.activeImage-1);return false})}else{e(t).hide()}if(Lightbox.total>1&&Lightbox.loopSlides||Lightbox.activeImage!=Lightbox.total-1){e(n).css({zIndex:"10500"}).show().click(function(){if(Lightbox.pauseOnNextClick){Lightbox.togglePlayPause("lightshowPause","lightshowPlay")}Lightbox.changeData(Lightbox.activeImage+1);return false})}else{e(n).hide()}}else{if((Lightbox.isLightframe||Lightbox.isModal||Lightbox.isVideo)&&!Lightbox.alternative_layout){e("#frameHoverNav").css({zIndex:"10500"}).show();e("#hoverNav").css({zIndex:"10500"}).hide();t="#framePrevLink";n="#frameNextLink"}if(Lightbox.total>1&&Lightbox.loopItems||Lightbox.activeImage!==0){e(t).css({zIndex:"10500"}).show().unbind().click(function(){Lightbox.changeData(Lightbox.activeImage-1);return false})}else{e(t).hide()}if(Lightbox.total>1&&Lightbox.loopItems||Lightbox.activeImage!=Lightbox.total-1){e(n).css({zIndex:"10500"}).show().unbind().click(function(){Lightbox.changeData(Lightbox.activeImage+1);return false})}else{e(n).hide()}}if(!Lightbox.isModal){this.enableKeyboardNav()}},enableKeyboardNav:function(){e(document).bind("keydown",this.keyboardAction)},disableKeyboardNav:function(){e(document).unbind("keydown",this.keyboardAction)},keyboardAction:function(e){if(e===null){keycode=event.keyCode;escapeKey=27}else{keycode=e.keyCode;escapeKey=e.DOM_VK_ESCAPE}key=String.fromCharCode(keycode).toLowerCase();if(Lightbox.checkKey(Lightbox.keysClose,key,keycode)){Lightbox.end("forceClose")}else if(Lightbox.checkKey(Lightbox.keysPrevious,key,keycode)){if(Lightbox.total>1&&(Lightbox.isSlideshow&&Lightbox.loopSlides||!Lightbox.isSlideshow&&Lightbox.loopItems)||Lightbox.activeImage!==0){Lightbox.changeData(Lightbox.activeImage-1)}}else if(Lightbox.checkKey(Lightbox.keysNext,key,keycode)){if(Lightbox.total>1&&(Lightbox.isSlideshow&&Lightbox.loopSlides||!Lightbox.isSlideshow&&Lightbox.loopItems)||Lightbox.activeImage!=Lightbox.total-1){Lightbox.changeData(Lightbox.activeImage+1)}}else if(Lightbox.checkKey(Lightbox.keysZoom,key,keycode)&&!Lightbox.disableResize&&!Lightbox.disableZoom&&!Lightbox.isSlideshow&&!Lightbox.isLightframe){if(Lightbox.isZoomedIn){Lightbox.changeData(Lightbox.activeImage,false)}else if(!Lightbox.isZoomedIn){Lightbox.changeData(Lightbox.activeImage,true)}return false}else if(Lightbox.checkKey(Lightbox.keysPlayPause,key,keycode)&&Lightbox.isSlideshow){if(Lightbox.isPaused){Lightbox.togglePlayPause("lightshowPlay","lightshowPause")}else{Lightbox.togglePlayPause("lightshowPause","lightshowPlay")}return false}},preloadNeighborImages:function(){if(Lightbox.total-1>Lightbox.activeImage){preloadNextImage=new Image;preloadNextImage.src=Lightbox.imageArray[Lightbox.activeImage+1][0]}if(Lightbox.activeImage>0){preloadPrevImage=new Image;preloadPrevImage.src=Lightbox.imageArray[Lightbox.activeImage-1][0]}},end:function(t){var n=t=="slideshow"?false:true;if(Lightbox.isSlideshow&&Lightbox.isPaused&&!n){return}if(Lightbox.inprogress===true&&t!="forceClose"){return}Lightbox.disableKeyboardNav();e("#lightbox").hide();e("#lightbox2-overlay").fadeOut();Lightbox.isPaused=true;Lightbox.inprogress=false;Lightbox.toggleSelectsFlash("visible");if(Lightbox.isSlideshow){for(var r=0;r<Lightbox.slideIdCount;r++){window.clearTimeout(Lightbox.slideIdArray[r])}e("#lightshowPause, #lightshowPlay").hide()}else if(Lightbox.isLightframe){e("#frameContainer").empty().hide()}else if(Lightbox.isVideo||Lightbox.isModal){if(!Lightbox.auto_modal){e("#modalContainer").hide().html("")}Lightbox.auto_modal=false}},getPageScroll:function(){var e,t;if(self.pageYOffset||self.pageXOffset){t=self.pageYOffset;e=self.pageXOffset}else if(document.documentElement&&(document.documentElement.scrollTop||document.documentElement.scrollLeft)){t=document.documentElement.scrollTop;e=document.documentElement.scrollLeft}else if(document.body){t=document.body.scrollTop;e=document.body.scrollLeft}arrayPageScroll=[e,t];return arrayPageScroll},getPageSize:function(){var e,t;if(window.innerHeight&&window.scrollMaxY){e=window.innerWidth+window.scrollMaxX;t=window.innerHeight+window.scrollMaxY}else if(document.body.scrollHeight>document.body.offsetHeight){e=document.body.scrollWidth;t=document.body.scrollHeight}else{e=document.body.offsetWidth;t=document.body.offsetHeight}var n,r;if(self.innerHeight){if(document.documentElement.clientWidth){n=document.documentElement.clientWidth}else{n=self.innerWidth}r=self.innerHeight}else if(document.documentElement&&document.documentElement.clientHeight){n=document.documentElement.clientWidth;r=document.documentElement.clientHeight}else if(document.body){n=document.body.clientWidth;r=document.body.clientHeight}if(t<r){pageHeight=r}else{pageHeight=t}if(e<n){pageWidth=e}else{pageWidth=n}arrayPageSize=new Array(pageWidth,pageHeight,n,r);return arrayPageSize},pause:function(e){var t=new Date;var n=null;do{n=new Date}while(n-t<e)},toggleSelectsFlash:function(t){if(t=="visible"){e("select.lightbox_hidden, embed.lightbox_hidden, object.lightbox_hidden").show()}else if(t=="hide"){e("select:visible, embed:visible, object:visible").not("#lightboxAutoModal select, #lightboxAutoModal embed, #lightboxAutoModal object").addClass("lightbox_hidden");e("select.lightbox_hidden, embed.lightbox_hidden, object.lightbox_hidden").hide()}},parseRel:function(t){var n=[];n["rel"]=n["title"]=n["group"]=n["style"]=n["flashvars"]=null;if(!e(t).attr("rel"))return n;n["rel"]=e(t).attr("rel").match(/\w+/)[0];if(e(t).attr("rel").match(/\[(.*)\]/)){var r=e(t).attr("rel").match(/\[(.*?)\]/)[1].split("|");n["group"]=r[0];n["style"]=r[1];if(n["style"]!=undefined&&n["style"].match(/flashvars:\s?(.*?);/)){n["flashvars"]=n["style"].match(/flashvars:\s?(.*?);/)[1]}}if(e(t).attr("rel").match(/\[.*\]\[(.*)\]/)){n["title"]=e(t).attr("rel").match(/\[.*\]\[(.*)\]/)[1]}return n},setStyles:function(e,t){e.width=Lightbox.iframe_width;e.height=Lightbox.iframe_height;e.scrolling="auto";if(!t)return e;var n=t.split(";");for(var r=0;r<n.length;r++){if(n[r].indexOf("width:")>=0){var i=n[r].replace("width:","");e.width=jQuery.trim(i)}else if(n[r].indexOf("height:")>=0){var s=n[r].replace("height:","");e.height=jQuery.trim(s)}else if(n[r].indexOf("scrolling:")>=0){var o=n[r].replace("scrolling:","");e.scrolling=jQuery.trim(o)}else if(n[r].indexOf("overflow:")>=0){var u=n[r].replace("overflow:","");e.overflow=jQuery.trim(u)}}return e},togglePlayPause:function(t,n){if(Lightbox.isSlideshow&&t=="lightshowPause"){for(var r=0;r<Lightbox.slideIdCount;r++){window.clearTimeout(Lightbox.slideIdArray[r])}}e("#"+t).hide();e("#"+n).show();if(t=="lightshowPlay"){Lightbox.isPaused=false;if(!Lightbox.loopSlides&&Lightbox.activeImage==Lightbox.total-1){Lightbox.end()}else if(Lightbox.total>1){Lightbox.changeData(Lightbox.activeImage+1)}}else{Lightbox.isPaused=true}},triggerLightbox:function(t,n){if(t.length){if(n&&n.length){e("a[rel^='"+t+"["+n+"]'], area[rel^='"+t+"["+n+"]']").eq(0).trigger("click")}else{e("a[rel^='"+t+"'], area[rel^='"+t+"']").eq(0).trigger("click")}}},detectMacFF2:function(){var e=navigator.userAgent.toLowerCase();if(/firefox[\/\s](\d+\.\d+)/.test(e)){var t=new Number(RegExp.$1);if(t<3&&e.indexOf("mac")!=-1){return true}}return false},checkKey:function(e,t,n){return jQuery.inArray(t,e)!=-1||jQuery.inArray(String(n),e)!=-1},filterXSS:function(t,n){var r="";e.ajax({url:Drupal.settings.basePath+"system/lightbox2/filter-xss",data:{string:t,allowed_tags:n},type:"POST",async:false,dataType:"json",success:function(e){r=e}});return r}};Drupal.behaviors.initLightbox={attach:function(t){e("body:not(.lightbox-processed)",t).addClass("lightbox-processed").each(function(){Lightbox.initialize();return false});Lightbox.initList(t);e("#lightboxAutoModal",t).triggerHandler("click")}}})(jQuery)